<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <arg name="robot_namespace" />
    <arg name="rname" />

    <!-- launch move_base -->
    
    <!--
    <include file="$(find unitree_move_base)/launch/move_base.launch">
        <arg name="rname" value="go1"/>
    </include>
    -->

    <rosparam file="$(find arena-simulation-setup)/robot/go1/costmaps/costmap_common_params.yaml" command="load" ns="move_base/global_costmap" />
    <rosparam file="$(find arena-simulation-setup)/robot/go1/costmaps/costmap_common_params.yaml" command="load" ns="move_base/local_costmap" />
    

    <!-- Load joint controller configurations from YAML file to parameter server -->
    <rosparam command="load" file="$(find arena-simulation-setup)/robot/go1/control.yaml" /> 
    <param name="/robot_description" command="$(find xacro)/xacro '$(find arena-simulation-setup)/robot/go1/xacro/robot.xacro'"/>

    <!-- load the controllers -->
    <node pkg="controller_manager" type="spawner" name="go1_controller_spawner" respawn="false" output="screen" args="
        joint_state_controller
        FR_hip_controller FR_thigh_controller FR_calf_controller 
        FL_hip_controller FL_thigh_controller FL_calf_controller 
        RR_hip_controller RR_thigh_controller RR_calf_controller
        RL_hip_controller RL_thigh_controller RL_calf_controller"/>

    <!-- load the parameter unitree_controller -->
    <include file="$(find unitree_controller_go1)/launch/set_ctrl.launch">
        <arg name="robot_namespace" value="/$(arg robot_namespace)"/>
        <arg name="target_state" value="5" /> <!-- 5 for move_base -->
    </include>
  

    <!-- spawn base controller -->
    <node 
        name="odom_pub" 
        pkg="gazebo_utils" 
        type="odom.py" 
        args="$(arg robot_namespace)" 
            />
</launch>   